---
output: github_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = FALSE)
options(width = 70)
```

## Getting started with rtweet


### Installing rtweet

Install from CRAN using `install.packages`.

```{r}
## install from CRAN
install.packages("rtweet")
```

Alternatively, install the most recent [development] version from
Github using `install_github` (from the devtools package).

```{r}
## install from Github (dev version)
if (!"devtools" %in% installed.packages()) {
    install.packages("devtools")
}
devtools::install_github("mkearney/rtweet", build_vignettes = TRUE)
```

### Authorizing access to Twitter's APIs

I've tried to make the API token [oauth] process as painless as
possible. That's why I've included the "auth" vignette, which ships
with the package and contains step-by-step instructions on how to
create and manage your Twitter API token. The vignette also includes
instructions for saving a token as an environment variable, which
automates the token-loading process for all future sessions (at least,
for the machine you're using). View the
[authorization vignette online](https://mkearney.github.io/rtweet/articles/auth.html)
or enter the following code into your R console to load the vignette locally:

```{r}
## Open Twitter token vignette in web browser.
vignette(topic = "auth", package = "rtweet")
```

### Package documentation

In addition to the API authorization vignette, rtweet also includes a
[brief package overview vignette](https://mkearney.github.io/rtweet/articles/intro.html)
as well as a
[vignette demonstrating how to access Twitter's stream API](https://mkearney.github.io/rtweet/articles/stream.html). To
open the vignettes locally, use the code below.

```{r}
vignette(topic = "intro", package = "rtweet")
vignette(topic = "stream", package = "rtweet")
```

And thanks to Hadley et al.'s
[pkgdown package](https://github.com/hadley/pkgdown) rtweet now has a
dedicated
[package documentation website](https://mkearney.github.io/rtweet). If
you'd like to contribute to rtweet, or if you run into any bugs, users
are encouraged to
[create an issue](https://github.com/mkearney/rtweet/issues) on
[rtweet's Github page](https://github.com/mkearney/rtweet).

### Searching for tweets

Searching for tweets is easy.

```{r}
## load rtweet
library(rtweet)

## search for tweets containing ICA17 or ICA2017 (not case sensitive)
ica17 <- search_tweets("#ica17 OR #ica2017", n = 10000, include_rts = FALSE)
```

If you haven't downloaded ggplot2 yet, the plot that's created will
look a little different than the plot below. That's because ggplot2 is
only listed as a *recommended* (not required) package. If ggplot2 is
installed on your machine, then `ts_plot` will return a ggplot object,
which can be modified like any ggplot.

```{r}
## plot a time series of tweets, aggregating by one-hour intervals
ts_plot(ica17, "hours") +
    ggplot2::labs(
        x = "Date and time of tweets",
        y = "Frequency of tweets",
        title = "Time series of #ICA17 tweets",
        subtitle = "Frequency of Twitter statuses calculated in one-hour intervals."
    ) +
    ggplot2::ggsave(file.path("..", "docs", "img", "ica17tweets.png"),
                    device = "png",
                    width = 7, height = 5, units = "in")
```

<p align="center">
<img src="img/ica17tweets.png" alt="ica17tweets">
</p>



## Analyzing text

```{r}
## strip text of tweets
plain_tweets(ica17$text[1:10])

## tokenize by word
wrds <- plain_tweets(ica17$text, tokenize = TRUE)

## freq table of all words
wrds <- table(unlist(wrds))

## get stop words
stopwords <- search_tweets(paste(letters, collapse = " OR "), n = 1000, include_rts = FALSE)
stopwords <- plain_tweets(stopwords$text, tokenize = TRUE)
stopwords <- table(unlist(stopwords))

## rm stop words
wrds <- wrds[!names(wrds) %in% names(stopwords[stopwords > 10L])]

## word cloud
cols <- sample(rainbow(10, s = .5, v = .75), 10)
png("../docs/img/wordcloud.png", 7, 7, "in", res = 127.5)
par(bg = "black")
wordcloud::wordcloud(names(wrds), wrds, min.freq = 5, random.color = FALSE, colors = cols,
                     family = "Roboto Condensed", font = 1, scale = c(4.75, .75))
dev.off()
```


<p align="center">
<img src="img/wordcloud.png" alt="wordcloud">
</p>
